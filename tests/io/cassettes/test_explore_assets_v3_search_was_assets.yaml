interactions:
- request:
    body: '{"limit": 200, "filter": {"and": [{"operator": "lt", "value": "2022-05-14T18:30:00.000Z",
      "property": "last_observed"}, {"operator": "eq", "value": ["522b0827-1780-42c5-9f70-2e481a845b41"],
      "property": "tags"}]}, "sort": [{"created": "desc"}]}'
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '243'
      Content-Type:
      - application/json
      User-Agent:
      - Integration/1.0 (pytest; pytenable-automated-testing; Build/unknown) pyTenable/1.4.6
        (Restfly/1.4.6; Python/3.10.4; Windows/AMD64)
      X-APIKeys:
      - accessKey=TIO_ACCESS_KEY;secretKey=TIO_SECRET_KEY
    method: POST
    uri: https://cloud.tenable.com/api/v3/assets/webapp/search
  response:
    body:
      string: '{"assets":[{"types":["webapp"],"sources":["WAS"],"last_licensed_scan_time":"2022-02-01T14:30:30.149Z","created":"2021-10-21T20:50:51.403Z","is_licensed":false,"ipv4_addresses":["142.251.111.153"],"homepage_screenshot_url":"https://cloud.tenable.com/was/v2/attachments/cbb1ffed-8e65-4a47-80c4-776252307654","tags":[{"id":"522b0827-1780-42c5-9f70-2e481a845b41","category":"Test_1_EDITED
        123","value":"111","type":"static"}],"display_ipv4_address":"142.251.111.153","first_observed":"2021-10-21T20:50:51.196Z","is_deleted":false,"ssl_tls_enabled":true,"last_observed":"2022-02-01T14:30:30.149Z","name":"google-gruyere.appspot.com","id":"094fe7aa-bd73-439f-abf1-40f5b0f419a4","updated":"2022-02-01T22:32:54.230Z"}],"pagination":{"limit":200,"total":1}}'
    headers:
      Cache-Control:
      - no-store
      Connection:
      - keep-alive
      Content-Length:
      - '748'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Tue, 14 Jun 2022 04:48:46 GMT
      Expect-CT:
      - enforce, max-age=86400
      Pragma:
      - no-cache
      Set-Cookie:
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - origin
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Gateway-Site-ID:
      - nginx-router-orlc5-ap-southeast-1-prod
      X-Request-Uuid:
      - 0c58c196fba31ed60d2f5bcd3396a565
      X-Xss-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: '{"limit": 200, "filter": {"and": [{"operator": "lt", "value": "2022-05-14T18:30:00.000Z",
      "property": "last_observed"}, {"operator": "eq", "value": ["522b0827-1780-42c5-9f70-2e481a845b41"],
      "property": "tags"}]}, "sort": [{"created": "desc"}]}'
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '243'
      Content-Type:
      - application/json
      Cookie:
      - nginx-cloud-site-id=us-2b
      User-Agent:
      - Integration/1.0 (pytest; pytenable-automated-testing; Build/unknown) pyTenable/1.4.6
        (Restfly/1.4.6; Python/3.10.4; Windows/AMD64)
      X-APIKeys:
      - accessKey=TIO_ACCESS_KEY;secretKey=TIO_SECRET_KEY
    method: POST
    uri: https://cloud.tenable.com/api/v3/assets/webapp/search
  response:
    body:
      string: '{"assets":[{"types":["webapp"],"sources":["WAS"],"last_licensed_scan_time":"2022-02-01T14:30:30.149Z","created":"2021-10-21T20:50:51.403Z","is_licensed":false,"ipv4_addresses":["142.251.111.153"],"homepage_screenshot_url":"https://cloud.tenable.com/was/v2/attachments/cbb1ffed-8e65-4a47-80c4-776252307654","tags":[{"id":"522b0827-1780-42c5-9f70-2e481a845b41","category":"Test_1_EDITED
        123","value":"111","type":"static"}],"display_ipv4_address":"142.251.111.153","first_observed":"2021-10-21T20:50:51.196Z","is_deleted":false,"ssl_tls_enabled":true,"last_observed":"2022-02-01T14:30:30.149Z","name":"google-gruyere.appspot.com","id":"094fe7aa-bd73-439f-abf1-40f5b0f419a4","updated":"2022-02-01T22:32:54.230Z"}],"pagination":{"limit":200,"total":1}}'
    headers:
      Cache-Control:
      - no-store
      Connection:
      - keep-alive
      Content-Length:
      - '748'
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Tue, 14 Jun 2022 04:48:47 GMT
      Expect-CT:
      - enforce, max-age=86400
      Pragma:
      - no-cache
      Set-Cookie:
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - origin
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Gateway-Site-ID:
      - nginx-router-orlc5-ap-southeast-1-prod
      X-Request-Uuid:
      - b3bdc79313235b43c95ec3cfcddcbe44
      X-Xss-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: '{"limit": 200, "filter": {"and": [{"operator": "lt", "value": "2022-05-14T18:30:00.000Z",
      "property": "last_observed"}, {"operator": "eq", "value": ["522b0827-1780-42c5-9f70-2e481a845b41"],
      "property": "tags"}]}, "sort": [{"created": "desc"}]}'
    headers:
      Accept:
      - text/csv
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '243'
      Content-Type:
      - application/json
      Cookie:
      - nginx-cloud-site-id=us-2b
      User-Agent:
      - Integration/1.0 (pytest; pytenable-automated-testing; Build/unknown) pyTenable/1.4.6
        (Restfly/1.4.6; Python/3.10.4; Windows/AMD64)
      X-APIKeys:
      - accessKey=TIO_ACCESS_KEY;secretKey=TIO_SECRET_KEY
    method: POST
    uri: https://cloud.tenable.com/api/v3/assets/webapp/search
  response:
    body:
      string: 'created,display_ipv4_address,first_observed,homepage_screenshot_url,id,ipv4_addresses,is_deleted,is_licensed,last_licensed_scan_time,last_observed,name,sources,ssl_tls_enabled,tags,types,updated

        2021-10-21T20:50:51.403Z,142.251.111.153,2021-10-21T20:50:51.196Z,"https://cloud.tenable.com/was/v2/attachments/cbb1ffed-8e65-4a47-80c4-776252307654","094fe7aa-bd73-439f-abf1-40f5b0f419a4",142.251.111.153,false,false,2022-02-01T14:30:30.149Z,2022-02-01T14:30:30.149Z,"google-gruyere.appspot.com",WAS,true,111,webapp,2022-02-01T22:32:54.230Z

        '
    headers:
      Cache-Control:
      - no-store
      Connection:
      - keep-alive
      Content-Length:
      - '536'
      Content-Type:
      - text/csv;charset=UTF-8
      Date:
      - Tue, 14 Jun 2022 04:48:49 GMT
      Expect-CT:
      - enforce, max-age=86400
      Pragma:
      - no-cache
      Set-Cookie:
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      - nginx-cloud-site-id=us-2b; path=/; HttpOnly; SameSite=Strict; Secure
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - origin
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Gateway-Site-ID:
      - nginx-router-orlc5-ap-southeast-1-prod
      X-Request-Uuid:
      - 96db74430e94b22b2f9df9c09e916b63
      X-Xss-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
version: 1
